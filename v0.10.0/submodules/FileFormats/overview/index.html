<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Overview · MathOptInterface</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">MathOptInterface</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Background</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../background/motivation/">Motivation</a></li><li><a class="tocitem" href="../../../background/duality/">Duality</a></li><li><a class="tocitem" href="../../../background/naming_conventions/">Naming conventions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/example/">Solving a problem using MathOptInterface</a></li><li><a class="tocitem" href="../../../tutorials/implementing/">Implementing a solver interface</a></li><li><a class="tocitem" href="../../../tutorials/mathprogbase/">Transitioning from MathProgBase</a></li><li><a class="tocitem" href="../../../tutorials/bridging_constraint/">Implementing a constraint bridge</a></li><li><a class="tocitem" href="../../../tutorials/manipulating_expressions/">Manipulating expressions</a></li><li><a class="tocitem" href="../../../tutorials/latency/">Latency</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../manual/standard_form/">Standard form problem</a></li><li><a class="tocitem" href="../../../manual/models/">Models</a></li><li><a class="tocitem" href="../../../manual/variables/">Variables</a></li><li><a class="tocitem" href="../../../manual/constraints/">Constraints</a></li><li><a class="tocitem" href="../../../manual/solutions/">Solutions</a></li><li><a class="tocitem" href="../../../manual/modification/">Problem modification</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../reference/standard_form/">Standard form</a></li><li><a class="tocitem" href="../../../reference/models/">Models</a></li><li><a class="tocitem" href="../../../reference/variables/">Variables</a></li><li><a class="tocitem" href="../../../reference/constraints/">Constraints</a></li><li><a class="tocitem" href="../../../reference/modification/">Modifications</a></li><li><a class="tocitem" href="../../../reference/nonlinear/">Nonlinear programming</a></li><li><a class="tocitem" href="../../../reference/callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../../reference/errors/">Errors</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Benchmarks/overview/">Overview</a></li><li><a class="tocitem" href="../../Benchmarks/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Bridges</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Bridges/overview/">Overview</a></li><li><a class="tocitem" href="../../Bridges/implementation/">Implementation</a></li><li><a class="tocitem" href="../../Bridges/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox" checked/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">FileFormats</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Overview</a><ul class="internal"><li><a class="tocitem" href="#Supported-file-types"><span>Supported file types</span></a></li><li><a class="tocitem" href="#Write-to-file"><span>Write to file</span></a></li><li><a class="tocitem" href="#Read-from-file"><span>Read from file</span></a></li><li><a class="tocitem" href="#Detecing-the-filetype-automatically"><span>Detecing the filetype automatically</span></a></li><li><a class="tocitem" href="#Unsupported-constraints"><span>Unsupported constraints</span></a></li><li><a class="tocitem" href="#Read-and-write-to-io"><span>Read and write to <code>io</code></span></a></li><li><a class="tocitem" href="#Validating-MOF-files"><span>Validating MOF files</span></a></li></ul></li><li><a class="tocitem" href="../reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Utilities/overview/">Overview</a></li><li><a class="tocitem" href="../../Utilities/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Test</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Test/overview/">Overview</a></li><li><a class="tocitem" href="../../Test/reference/">API Reference</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../release_notes/">Release notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Submodules</a></li><li><a class="is-disabled">FileFormats</a></li><li class="is-active"><a href>Overview</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Overview</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jump-dev/MathOptInterface.jl/blob/master/docs/src/submodules/FileFormats/overview.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-FileFormats-submodule"><a class="docs-heading-anchor" href="#The-FileFormats-submodule">The FileFormats submodule</a><a id="The-FileFormats-submodule-1"></a><a class="docs-heading-anchor-permalink" href="#The-FileFormats-submodule" title="Permalink"></a></h1><p>The <code>FileFormats</code> module provides functionality for reading and writing MOI models using <a href="../../../reference/models/#MathOptInterface.write_to_file"><code>write_to_file</code></a> and <a href="../../../reference/models/#MathOptInterface.read_from_file"><code>read_from_file</code></a>.</p><h2 id="Supported-file-types"><a class="docs-heading-anchor" href="#Supported-file-types">Supported file types</a><a id="Supported-file-types-1"></a><a class="docs-heading-anchor-permalink" href="#Supported-file-types" title="Permalink"></a></h2><p>You must read and write files to a <a href="../reference/#MathOptInterface.FileFormats.Model"><code>FileFormats.Model</code></a> object. Specifc the file-type by passing a <a href="../reference/#MathOptInterface.FileFormats.FileFormat"><code>FileFormats.FileFormat</code></a> enum. For example:</p><p><strong>The Conic Benchmark Format</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = MOI.FileFormats.Model(format = MOI.FileFormats.FORMAT_CBF)
A Conic Benchmark Format (CBF) model</code></pre><p><strong>The LP file format</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = MOI.FileFormats.Model(format = MOI.FileFormats.FORMAT_LP)
A .LP-file model</code></pre><p><strong>The MathOptFormat file format</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = MOI.FileFormats.Model(format = MOI.FileFormats.FORMAT_MOF)
A MathOptFormat Model</code></pre><p><strong>The MPS file format</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = MOI.FileFormats.Model(format = MOI.FileFormats.FORMAT_MPS)
A Mathematical Programming System (MPS) model</code></pre><p><strong>The NL file format</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = MOI.FileFormats.Model(format = MOI.FileFormats.FORMAT_NL)
An AMPL (.nl) model</code></pre><p><strong>The SDPA file format</strong></p><pre><code class="language-julia-repl hljs">julia&gt; model = MOI.FileFormats.Model(format = MOI.FileFormats.FORMAT_SDPA)
A SemiDefinite Programming Algorithm Format (SDPA) model</code></pre><h2 id="Write-to-file"><a class="docs-heading-anchor" href="#Write-to-file">Write to file</a><a id="Write-to-file-1"></a><a class="docs-heading-anchor-permalink" href="#Write-to-file" title="Permalink"></a></h2><p>To write a model <code>src</code> to a <a href="https://jump.dev/MathOptFormat/">MathOptFormat file</a>, use:</p><pre><code class="language-julia-repl hljs">julia&gt; src = MOI.Utilities.Model{Float64}()
MOIU.Model{Float64}

julia&gt; MOI.add_variable(src)
MathOptInterface.VariableIndex(1)

julia&gt; dest = MOI.FileFormats.Model(format = MOI.FileFormats.FORMAT_MOF)
A MathOptFormat Model

julia&gt; MOI.copy_to(dest, src)
MathOptInterface.Utilities.IndexMap with 1 entry:
  VariableIndex(1) =&gt; VariableIndex(1)

julia&gt; MOI.write_to_file(dest, &quot;file.mof.json&quot;)

julia&gt; print(read(&quot;file.mof.json&quot;, String))
{
  &quot;name&quot;: &quot;MathOptFormat Model&quot;,
  &quot;version&quot;: {
    &quot;major&quot;: 0,
    &quot;minor&quot;: 6
  },
  &quot;variables&quot;: [
    {
      &quot;name&quot;: &quot;x1&quot;
    }
  ],
  &quot;objective&quot;: {
    &quot;sense&quot;: &quot;feasibility&quot;
  },
  &quot;constraints&quot;: []
}</code></pre><h2 id="Read-from-file"><a class="docs-heading-anchor" href="#Read-from-file">Read from file</a><a id="Read-from-file-1"></a><a class="docs-heading-anchor-permalink" href="#Read-from-file" title="Permalink"></a></h2><p>To read a MathOptFormat file, use:</p><pre><code class="language-julia-repl hljs">julia&gt; dest = MOI.FileFormats.Model(format = MOI.FileFormats.FORMAT_MOF)
A MathOptFormat Model

julia&gt; MOI.read_from_file(dest, &quot;file.mof.json&quot;)

julia&gt; MOI.get(dest, MOI.ListOfVariableIndices())
1-element Vector{MathOptInterface.VariableIndex}:
 MathOptInterface.VariableIndex(1)

julia&gt; rm(&quot;file.mof.json&quot;)  # Clean up after ourselves.</code></pre><h2 id="Detecing-the-filetype-automatically"><a class="docs-heading-anchor" href="#Detecing-the-filetype-automatically">Detecing the filetype automatically</a><a id="Detecing-the-filetype-automatically-1"></a><a class="docs-heading-anchor-permalink" href="#Detecing-the-filetype-automatically" title="Permalink"></a></h2><p>Instead of the <code>format</code> keyword, you can also use the <code>filename</code> keyword argument to <a href="../reference/#MathOptInterface.FileFormats.Model"><code>FileFormats.Model</code></a>. This will attempt to automatically guess the format from the file extension. For example:</p><pre><code class="language-julia-repl hljs">julia&gt; src = MOI.Utilities.Model{Float64}()
MOIU.Model{Float64}

julia&gt; dest = MOI.FileFormats.Model(filename = &quot;file.cbf.gz&quot;)
A Conic Benchmark Format (CBF) model

julia&gt; MOI.copy_to(dest, src)
MathOptInterface.Utilities.IndexMap()

julia&gt; MOI.write_to_file(dest, &quot;file.cbf.gz&quot;)

julia&gt; src_2 = MOI.FileFormats.Model(filename = &quot;file.cbf.gz&quot;)
A Conic Benchmark Format (CBF) model

julia&gt; src = MOI.Utilities.Model{Float64}()
MOIU.Model{Float64}

julia&gt; dest = MOI.FileFormats.Model(filename = &quot;file.cbf.gz&quot;)
A Conic Benchmark Format (CBF) model

julia&gt; MOI.copy_to(dest, src)
MathOptInterface.Utilities.IndexMap()

julia&gt; MOI.write_to_file(dest, &quot;file.cbf.gz&quot;)

julia&gt; src_2 = MOI.FileFormats.Model(filename = &quot;file.cbf.gz&quot;)
A Conic Benchmark Format (CBF) model

julia&gt; MOI.read_from_file(src_2, &quot;file.cbf.gz&quot;)

julia&gt; rm(&quot;file.cbf.gz&quot;)  # Clean up after ourselves.</code></pre><p>Note how the compression format (GZip) is also automatically detected from the filename.</p><h2 id="Unsupported-constraints"><a class="docs-heading-anchor" href="#Unsupported-constraints">Unsupported constraints</a><a id="Unsupported-constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Unsupported-constraints" title="Permalink"></a></h2><p>In some cases <code>src</code> may contain constraints that are not supported by the file format (e.g., the CBF format supports integer variables but not binary). If so, you should copy <code>src</code> to a bridged model using <a href="../../Bridges/reference/#MathOptInterface.Bridges.full_bridge_optimizer"><code>Bridges.full_bridge_optimizer</code></a>:</p><pre><code class="language-julia hljs">src = MOI.Utilities.Model{Float64}()
x = MOI.add_variable(model)
MOI.add_constraint(model, x, MOI.ZeroOne())
dest = MOI.FileFormats.Model(format = MOI.FileFormats.FORMAT_CBF)
bridged = MOI.Bridges.full_bridge_optimizer(dest, Float64)
MOI.copy_to(bridged, src)
MOI.write_to_file(dest, &quot;my_model.cbf&quot;)</code></pre><p>You should also note that even after bridging, it may still not be possible to write the model to file because of unsupported constraints (e.g., PSD variables in the LP file format).</p><h2 id="Read-and-write-to-io"><a class="docs-heading-anchor" href="#Read-and-write-to-io">Read and write to <code>io</code></a><a id="Read-and-write-to-io-1"></a><a class="docs-heading-anchor-permalink" href="#Read-and-write-to-io" title="Permalink"></a></h2><p>In addition to <a href="../../../reference/models/#MathOptInterface.write_to_file"><code>write_to_file</code></a> and <a href="../../../reference/models/#MathOptInterface.read_from_file"><code>read_from_file</code></a>, you can read and write directly from <code>IO</code> streams using <code>Base.write</code> and <code>Base.read!</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; src = MOI.Utilities.Model{Float64}()
MOIU.Model{Float64}

julia&gt; dest = MOI.FileFormats.Model(format = MOI.FileFormats.FORMAT_MPS)
A Mathematical Programming System (MPS) model

julia&gt; MOI.copy_to(dest, src)
MathOptInterface.Utilities.IndexMap()

julia&gt; io = IOBuffer();

julia&gt; write(io, dest)

julia&gt; seekstart(io);

julia&gt; src_2 = MOI.FileFormats.Model(format = MOI.FileFormats.FORMAT_MPS)
A Mathematical Programming System (MPS) model

julia&gt; read!(io, src_2);</code></pre><h2 id="Validating-MOF-files"><a class="docs-heading-anchor" href="#Validating-MOF-files">Validating MOF files</a><a id="Validating-MOF-files-1"></a><a class="docs-heading-anchor-permalink" href="#Validating-MOF-files" title="Permalink"></a></h2><p>MathOptFormat files are governed by a schema. Use <a href="https://github.com/fredo-dedup/JSONSchema.jl">JSONSchema.jl</a> to check if a <code>.mof.json</code> file satisfies the schema.</p><p>First, construct the schema object as follows:</p><pre><code class="language-julia-repl hljs">julia&gt; import JSON, JSONSchema

julia&gt; schema = JSONSchema.Schema(JSON.parsefile(MOI.FileFormats.MOF.SCHEMA_PATH))
A JSONSchema</code></pre><p>Then, check if a model file is valid using <code>isvalid</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; good_model = JSON.parse(&quot;&quot;&quot;
       {
         &quot;version&quot;: {
           &quot;major&quot;: 0,
           &quot;minor&quot;: 6
         },
         &quot;variables&quot;: [{&quot;name&quot;: &quot;x&quot;}],
         &quot;objective&quot;: {&quot;sense&quot;: &quot;feasibility&quot;},
         &quot;constraints&quot;: []
       }
       &quot;&quot;&quot;);

julia&gt; isvalid(good_model, schema)
true</code></pre><p>If we construct an invalid file, for example by mis-typing <code>name</code> as <code>NaMe</code>, the validation fails:</p><pre><code class="language-julia-repl hljs">julia&gt; bad_model = JSON.parse(&quot;&quot;&quot;
       {
         &quot;version&quot;: {
           &quot;major&quot;: 0,
           &quot;minor&quot;: 6
         },
         &quot;variables&quot;: [{&quot;NaMe&quot;: &quot;x&quot;}],
         &quot;objective&quot;: {&quot;sense&quot;: &quot;feasibility&quot;},
         &quot;constraints&quot;: []
       }
       &quot;&quot;&quot;);

julia&gt; isvalid(bad_model, schema)
false</code></pre><p>Use <code>JSONSchema.validate</code> to obtain more insight into why the validation failed:</p><pre><code class="language-julia-repl hljs">julia&gt; JSONSchema.validate(bad_model, schema)
Validation failed:
path:         [variables][1]
instance:     Dict{String, Any}(&quot;NaMe&quot; =&gt; &quot;x&quot;)
schema key:   required
schema value: Any[&quot;name&quot;]</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../Bridges/reference/">« API Reference</a><a class="docs-footer-nextpage" href="../reference/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Tuesday 7 September 2021 02:00">Tuesday 7 September 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
