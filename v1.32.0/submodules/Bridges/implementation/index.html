<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Implementation · MathOptInterface</title><meta name="title" content="Implementation · MathOptInterface"/><meta property="og:title" content="Implementation · MathOptInterface"/><meta property="twitter:title" content="Implementation · MathOptInterface"/><meta name="description" content="Documentation for MathOptInterface."/><meta property="og:description" content="Documentation for MathOptInterface."/><meta property="twitter:description" content="Documentation for MathOptInterface."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">MathOptInterface</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><input class="collapse-toggle" id="menuitem-1" type="checkbox"/><label class="tocitem" for="menuitem-1"><span class="docs-label">Introduction</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../">Introduction</a></li><li><a class="tocitem" href="../../../background/motivation/">Motivation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/example/">Solving a problem using MathOptInterface</a></li><li><a class="tocitem" href="../../../tutorials/implementing/">Implementing a solver interface</a></li><li><a class="tocitem" href="../../../tutorials/mathprogbase/">Transitioning from MathProgBase</a></li><li><a class="tocitem" href="../../../tutorials/bridging_constraint/">Implementing a constraint bridge</a></li><li><a class="tocitem" href="../../../tutorials/manipulating_expressions/">Manipulating expressions</a></li><li><a class="tocitem" href="../../../tutorials/latency/">Latency</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../manual/standard_form/">Standard form problem</a></li><li><a class="tocitem" href="../../../manual/models/">Models</a></li><li><a class="tocitem" href="../../../manual/variables/">Variables</a></li><li><a class="tocitem" href="../../../manual/constraints/">Constraints</a></li><li><a class="tocitem" href="../../../manual/solutions/">Solutions</a></li><li><a class="tocitem" href="../../../manual/modification/">Problem modification</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Background</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../background/duality/">Duality</a></li><li><a class="tocitem" href="../../../background/infeasibility_certificates/">Infeasibility certificates</a></li><li><a class="tocitem" href="../../../background/naming_conventions/">Naming conventions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../reference/standard_form/">Standard form</a></li><li><a class="tocitem" href="../../../reference/models/">Models</a></li><li><a class="tocitem" href="../../../reference/variables/">Variables</a></li><li><a class="tocitem" href="../../../reference/constraints/">Constraints</a></li><li><a class="tocitem" href="../../../reference/modification/">Modifications</a></li><li><a class="tocitem" href="../../../reference/nonlinear/">Nonlinear programming</a></li><li><a class="tocitem" href="../../../reference/callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../../reference/errors/">Errors</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">Submodules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Benchmarks/overview/">Overview</a></li><li><a class="tocitem" href="../../Benchmarks/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox" checked/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">Bridges</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../overview/">Overview</a></li><li class="is-active"><a class="tocitem" href>Implementation</a><ul class="internal"><li><a class="tocitem" href="#SetMap-bridges"><span>SetMap bridges</span></a></li><li><a class="tocitem" href="#final_touch"><span><code>final_touch</code></span></a></li><li><a class="tocitem" href="#Testing"><span>Testing</span></a></li></ul></li><li><a class="tocitem" href="../list_of_bridges/">List of bridges</a></li><li><a class="tocitem" href="../reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">FileFormats</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../FileFormats/overview/">Overview</a></li><li><a class="tocitem" href="../../FileFormats/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Nonlinear</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Nonlinear/overview/">Overview</a></li><li><a class="tocitem" href="../../Nonlinear/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Utilities/overview/">Overview</a></li><li><a class="tocitem" href="../../Utilities/reference/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Test</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Test/overview/">Overview</a></li><li><a class="tocitem" href="../../Test/reference/">API Reference</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Developer Docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../developer/checklists/">Checklists</a></li></ul></li><li><a class="tocitem" href="../../../release_notes/">Release notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Submodules</a></li><li><a class="is-disabled">Bridges</a></li><li class="is-active"><a href>Implementation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Implementation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jump-dev/MathOptInterface.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jump-dev/MathOptInterface.jl/blob/master/docs/src/submodules/Bridges/implementation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Implementing-a-bridge"><a class="docs-heading-anchor" href="#Implementing-a-bridge">Implementing a bridge</a><a id="Implementing-a-bridge-1"></a><a class="docs-heading-anchor-permalink" href="#Implementing-a-bridge" title="Permalink"></a></h1><p>The easiest way to implement a bridge is to follow an existing example. There are three locations of bridges in the source code:</p><ul><li>Constraint bridges are stored in <code>src/Bridges/Constraint/bridges</code></li><li>Objective bridges are stored in <code>src/Bridges/Objective/bridges</code></li><li>Variable bridges are stored in <code>src/Bridges/Variable/bridges</code></li></ul><p>The <a href="../../../tutorials/bridging_constraint/#Implementing-a-constraint-bridge">Implementing a constraint bridge</a> tutorial has a more detailed guide on what is required to implement a bridge.</p><p>When opening a pull request that adds a new bridge, use the checklist <a href="../../../developer/checklists/#Adding-a-new-bridge">Adding a new bridge</a>.</p><p>If you need help or advice, please contact the <a href="https://jump.dev/chatroom/">Developer Chatroom</a>.</p><h2 id="SetMap-bridges"><a class="docs-heading-anchor" href="#SetMap-bridges">SetMap bridges</a><a id="SetMap-bridges-1"></a><a class="docs-heading-anchor-permalink" href="#SetMap-bridges" title="Permalink"></a></h2><p>For constraint and variable bridges, a common reformulation is that <span>$f(x) \in F$</span> is reformulated to <span>$g(x) \in G$</span>. In this case, no additional variables and constraints are added, and the bridge needs only a way to map between the functions <code>f</code> and <code>g</code> and the sets <code>F</code> and <code>G</code>.</p><p>To implementation a bridge of this form, subtype the abstract type <a href="../list_of_bridges/#MathOptInterface.Bridges.Constraint.SetMapBridge"><code>Bridges.Constraint.SetMapBridge</code></a> or <a href="../list_of_bridges/#MathOptInterface.Bridges.Variable.SetMapBridge"><code>Bridges.Variable.SetMapBridge</code></a> and implement the API described in the docstring of each type.</p><h2 id="final_touch"><a class="docs-heading-anchor" href="#final_touch"><code>final_touch</code></a><a id="final_touch-1"></a><a class="docs-heading-anchor-permalink" href="#final_touch" title="Permalink"></a></h2><p>Some bridges require information from other parts of the model. One set of examples are the various combinatorial <code>ToMILP</code> bridges, such as <a href="../list_of_bridges/#MathOptInterface.Bridges.Constraint.SOS1ToMILPBridge"><code>Bridges.Constraint.SOS1ToMILPBridge</code></a>, which require knowledge of the variable bounds.</p><p>Bridges requiring information from other parts of the model should implement <a href="../reference/#MathOptInterface.Bridges.final_touch"><code>Bridges.final_touch</code></a> and <a href="../reference/#MathOptInterface.Bridges.needs_final_touch"><code>Bridges.needs_final_touch</code></a>.</p><p>During the bridge&#39;s construction, store the function and set and make no changes to the underlying model. Then, in <a href="../reference/#MathOptInterface.Bridges.final_touch"><code>Bridges.final_touch</code></a>, query the additional information and add the reformulated problem to the <code>model</code>.</p><p>When implementing, you must consider that:</p><ul><li><a href="../reference/#MathOptInterface.Bridges.final_touch"><code>Bridges.final_touch</code></a> may be called multiple times, so that your reformulation should be applied only if necessary. Sometimes the additional data will be the same, and sometimes it may be different.</li><li>We do not currently support <code>final_touch</code> bridges that introduce constraints which also require a <code>final_touch</code> bridge. Therefore, you should implement <code>final_touch</code> only if necessary, and we recommend that you contact the <a href="https://jump.dev/chatroom/">Developer Chatroom</a> for advice before doing so.</li></ul><h2 id="Testing"><a class="docs-heading-anchor" href="#Testing">Testing</a><a id="Testing-1"></a><a class="docs-heading-anchor-permalink" href="#Testing" title="Permalink"></a></h2><p>Use the <a href="../reference/#MathOptInterface.Bridges.runtests"><code>Bridges.runtests</code></a> function to test a bridge. It takes three arguments: the type of the bridge, the input model as a string, and the output model as a string.</p><p>Here is an example:</p><pre><code class="language-julia-repl hljs">julia&gt; MOI.Bridges.runtests(
           MOI.Bridges.Constraint.GreaterToLessBridge,
           &quot;&quot;&quot;
           variables: x
           x &gt;= 1.0
           &quot;&quot;&quot;,
           &quot;&quot;&quot;
           variables: x
           -1.0 * x &lt;= -1.0
           &quot;&quot;&quot;,
       )</code></pre><p>There are a number of other useful keyword arguments.</p><ul><li><code>eltype</code> can be used to specify the element type of the model (and bridge). It defaults to <code>Float64</code>.</li><li><code>variable_start</code> and <code>constraint_start</code> are used as the values to set the <a href="../../../reference/variables/#MathOptInterface.VariablePrimalStart"><code>VariablePrimalStart</code></a> and <a href="../../../reference/constraints/#MathOptInterface.ConstraintPrimalStart"><code>ConstraintPrimalStart</code></a> attributes to. They default to <code>1.2</code>. If you use a different <code>eltype</code>, you must set appropriate starting values of the same type. The default <code>1.2</code> was chosen to minimize the risk that the starting point is undefined, which could happen for common situations like <code>0.0</code> and <code>1.0</code>. The tests associated with the starting values do not necessarily check for correctness, only that they can be <code>set</code> and <code>get</code> to produce the same result.</li><li><code>print_inner_model</code> can be used to print the reformulated output model from the bridge. This is especially helpful during debugging to see what the bridge is doing, and to spot mistakes. It defaults to <code>false</code>.</li></ul><p>Here is an example:</p><pre><code class="language-julia-repl hljs">julia&gt; MOI.Bridges.runtests(
           MOI.Bridges.Constraint.GreaterToLessBridge,
           &quot;&quot;&quot;
           variables: x
           x &gt;= 1
           &quot;&quot;&quot;,
           &quot;&quot;&quot;
           variables: x
           ::Int: -1 * x &lt;= -1
           &quot;&quot;&quot;;
           eltype = Int,
           print_inner_model = true,
           variable_start = 2,
           constraint_start = 2,
       )
Feasibility

Subject to:

ScalarAffineFunction{Int64}-in-LessThan{Int64}
 (0) - (1) x &lt;= (-1)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../overview/">« Overview</a><a class="docs-footer-nextpage" href="../list_of_bridges/">List of bridges »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 21 October 2024 08:02">Monday 21 October 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
